(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[8,27,28,58,79],{17:function(e,t,n){"use strict";n.r(t),n.d(t,"showAlert",(function(){return a}));var a=function(e,t){if(document.getElementById("error")){var n=window.sessionStorage.getItem("removeAlert");clearTimeout(n),document.getElementById("error").remove()}var a=document.createElement("div");if(a.id="error",a.innerHTML='<div class="alert alert-warning alert-dismissible fade show" role="alert" style="text-align:center">'+e+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>',document.body.appendChild(a),-1!=t){var s=setTimeout((function(){document.getElementById("error")&&document.getElementById("error").remove()}),t);window.sessionStorage.setItem("removeAlert",s)}}},184:function(e,t){},185:function(e,t){},315:function(e,t){},317:function(e,t){},43:function(e,t,n){"use strict";n.r(t);var a=n(4),s=n(14),i=n(2),o=n(11),r=n(46),c=n(12),l=n(13),u=n(1),d=n.n(u),m=n(47),f=n.n(m),h=n(279),v=n.n(h),g=n(17),w=n(3),p=n(5),k=n(68),T=(n(95),function(e){Object(l.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={score:0,checkPointId:-1,scanNo:0},a.handleResult=a.handleResult.bind(Object(r.a)(a)),a.countTimeLeft=a.countTimeLeft.bind(Object(r.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=(new p.default).getCookie("username"),t=window.localStorage.getItem("guest");if(!e&&!(t&&t.indexOf("-")>0))return window.alert("Login or access as a guest to start scanning..."),window.location.href="/",!1;this.setState({score:0,checkPointId:-1,scanNo:0});var n=this;if(document.getElementById("preview")){var i=new v.a.Scanner({video:document.getElementById("preview"),scanPeriod:5,mirror:!1});i.addListener("scan",(function(e){n.setState(Object(s.a)({},n.state,Object(a.a)({},"scanText",e))),n.handleResult()})),v.a.Camera.getCameras().then((function(e){e.length>0?i.start(e[0]):window.alert("No camera found")}))}var o=window.setInterval(this.countTimeLeft,1e3);window.sessionStorage.setItem("countTimeLeft",o),Object(k.default)()}},{key:"componentDidUpdate",value:function(){document.getElementById("scanResults")&&this.renderResult(),Object(k.default)()}},{key:"componentWillUnmount",value:function(){clearInterval(window.sessionStorage.countTimeLeft)}},{key:"render",value:function(){return d.a.createElement("div",{id:"scan",className:"scan"},d.a.createElement("video",{id:"preview"}),d.a.createElement("div",{id:"scanResults",className:"scanResults col-8 col-sm-6 mx-auto justify-content-center py-4 shadow"},d.a.createElement("h4",{className:"col-12 mb-3"},"Result"),d.a.createElement("div",{className:"col-10 d-flex flex-row justify-content-center mx-auto p-3 shadow"},d.a.createElement("div",{className:"px-1"},d.a.createElement("div",{className:"text-left"},"Checkpoint No"),d.a.createElement("div",{className:"text-left"},"Number of Scans"),d.a.createElement("div",{className:"text-left"},"Time Taken"),d.a.createElement("div",{className:"text-left"},"Score"==this.state.course?"Score":""),d.a.createElement("div",{className:"text-left"},"Position"),d.a.createElement("div",{className:"text-left"},"Time Left")),d.a.createElement("div",{id:"result",className:"result px-1"}))))}},{key:"handleResult",value:function(){var e=this,t=new Date,n=t.getFullYear()+"-"+(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+t.getDate(),a=(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()),s=this.state.scanText.slice().split("-");if(s.length<6)return Object(g.showAlert)("Invalid QRCode",5e3),this.setState({error:"Invalid QRCode"}),!1;if(s.length>5&&-1==this.state.checkPointId){var i=s[3];this.setState({firstCheckPoint:i,checkPointId:i-1})}var o=new p.default;(new w.default).postData("/results/addGuestResult/",{today:n,currentTime:a,username:o.getCookie("username")?o.getCookie("username"):window.localStorage.getItem("guest"),scanText:this.state.scanText,checkPointId:this.state.checkPointId,score:this.state.score,timeTaken:this.calculateTimeTaken(),scanNo:this.state.scanNo}).then((function(n){if(console.log(n),n.error)console.log(n.error),n.endTime&&(window.sessionStorage.setItem("event",s[1]),window.sessionStorage.setItem("course",s[2]),window.sessionStorage.setItem("checkpointNo",s[4]),window.location.href="/guest/result"),Object(g.showAlert)(n.error,5e3),e.setState({error:n.error}),console.log(e.state);else{if(console.log(n),n.startTime){if(n.endTime<a)window.location.href="guest/result";else{var i=n.endTime.split(":");i=3600*i[0]+60*i[1],a=3600*t.getHours()+60*t.getMinutes(),setTimeout((function(){window.location.href="guest/result"}),1e3*(i-a))}e.setState({startTime:n.startTime,endTime:n.endTime})}var o=parseInt(n.timeTaken/3600),r=parseInt((n.timeTaken-3600*o)/60),c=n.timeTaken-3600*o-60*r;o=0==(o=o<10?"0"+o:o)?"":o+" h ",r=r<10?"0"+r+" m ":r+" m ",c=c<10?"0"+c+" s":c+" s",e.setState({checkPointId:n.checkPointId,score:n.score,timeTaken:o+r+c,scanNo:n.scanNo,position:n.position}),console.log(e.state)}}))}},{key:"calculateTimeTaken",value:function(){if("0"!=this.state.scanNo){var e=this.state.startTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date;return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()-e}return-1}},{key:"countTimeLeft",value:function(){if(this.state.scanNo>0){var e=this.state.endTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date,n=e-(3600*t.getHours()+60*t.getMinutes()+t.getSeconds()),a=parseInt(n/3600),s=parseInt((n-3600*a)/60),i=n-3600*a-60*s;n=(a=0==(a=a<10?"0"+a:a)?"":a+" : ")+(s=s<10?"0"+s+" : ":s+" : ")+(i=i<10?"0"+i:i),this.setState({timeLeft:n})}}},{key:"renderResult",value:function(){var e=[];this.state.scanNo>0?e.push(d.a.createElement("div",{key:"result"},d.a.createElement("div",{className:"text-left"},": ",this.state.checkPointId-this.state.firstCheckPoint+1),d.a.createElement("div",{className:"text-left"},": ",this.state.scanNo),d.a.createElement("div",{className:"text-left"},": ",this.state.timeTaken),d.a.createElement("div",{className:"text-left"},"Score"==this.state.course?": "+this.state.score:""),d.a.createElement("div",{className:"text-left"},": ",this.state.position),d.a.createElement("div",{className:"text-left"},": ",this.state.timeLeft))):e.push(d.a.createElement("div",{key:"result"},d.a.createElement("div",null,": --"),d.a.createElement("div",null,": --"),d.a.createElement("div",null,": --"),d.a.createElement("div",null,"Score"==this.state.course?": --":""),d.a.createElement("div",null,": --"),d.a.createElement("div",null,": --"))),f.a.render(e,document.getElementById("result"))}}]),n}(d.a.Component));t.default=T},68:function(e,t,n){"use strict";n.r(t);var a=n(0);function s(){Object(a.eId)("preview").style.height=window.innerHeight+"px"}t.default=function(){Object(a.darkLightMode)("scanResults"),s();var e=navigator.userAgent||navigator.vendor||window.opera;/android/i.test(e)||window.addEventListener("resize",s)}},95:function(e,t,n){}}]);
//# sourceMappingURL=8.a4a2d090.chunk.js.map