(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[8,27,28,58,79],{17:function(e,t,a){"use strict";a.r(t),a.d(t,"showAlert",(function(){return n}));var n=function(e,t){if(document.getElementById("error")){var a=window.sessionStorage.getItem("removeAlert");clearTimeout(a),document.getElementById("error").remove()}var n=document.createElement("div");if(n.id="error",n.innerHTML='<div class="alert alert-warning alert-dismissible fade show" role="alert" style="text-align:center">'+e+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>',document.body.appendChild(n),-1!=t){var s=setTimeout((function(){document.getElementById("error")&&document.getElementById("error").remove()}),t);window.sessionStorage.setItem("removeAlert",s)}}},184:function(e,t){},185:function(e,t){},315:function(e,t){},317:function(e,t){},43:function(e,t,a){"use strict";a.r(t);var n=a(5),s=a(14),i=a(2),o=a(11),r=a(46),c=a(12),l=a(13),d=a(1),u=a.n(d),m=a(47),h=a.n(m),f=a(279),v=a.n(f),g=a(17),w=a(3),p=a(4),k=a(68),T=(a(95),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={score:0,checkPointId:-1,scanNo:0},n.handleResult=n.handleResult.bind(Object(r.a)(n)),n.countTimeLeft=n.countTimeLeft.bind(Object(r.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=(new p.default).getCookie("username"),t=window.localStorage.getItem("guest");if(!e&&!(t&&t.indexOf("-")>0))return window.alert("Login or access as a guest to start scanning..."),window.location.href=window.sessionStorage.path,!1;this.setState({score:0,checkPointId:-1,scanNo:0});var a=this;if(document.getElementById("preview")){var i=new v.a.Scanner({video:document.getElementById("preview"),scanPeriod:5,mirror:!1});i.addListener("scan",(function(e){a.setState(Object(s.a)({},a.state,Object(n.a)({},"scanText",e))),a.handleResult()})),v.a.Camera.getCameras().then((function(e){e.length>0?i.start(e[2]):window.alert("No camera found")}))}var o=window.setInterval(this.countTimeLeft,1e3);window.sessionStorage.setItem("countTimeLeft",o),Object(k.default)()}},{key:"componentDidUpdate",value:function(){document.getElementById("scanResults")&&this.renderResult(),Object(k.default)()}},{key:"componentWillUnmount",value:function(){clearInterval(window.sessionStorage.countTimeLeft)}},{key:"render",value:function(){return u.a.createElement("div",{id:"scan",className:"scan"},u.a.createElement("video",{id:"preview"}),u.a.createElement("div",{id:"scanResults",className:"scanResults col-11 col-sm-6 mx-auto justify-content-center py-4 shadow"},u.a.createElement("h4",{className:"col-12 mb-3"},"Result"),u.a.createElement("div",{className:"col-12 col-sm-10 d-flex flex-row justify-content-center mx-auto p-2 p-sm-3 shadow"},u.a.createElement("div",{className:"px-1"},u.a.createElement("div",{className:"text-left"},"Checkpoint No"),u.a.createElement("div",{className:"text-left"},"Number of Scans"),u.a.createElement("div",{className:"text-left"},"Time Taken"),u.a.createElement("div",{className:"text-left"},"Score"==this.state.course?"Score":""),u.a.createElement("div",{className:"text-left"},"Position"),u.a.createElement("div",{className:"text-left"},"Time Left")),u.a.createElement("div",{id:"result",className:"result px-1"}))))}},{key:"handleResult",value:function(){var e=this,t=new Date,a=t.getFullYear()+"-"+(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate()),n=(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()),s=this.state.scanText.slice().split("-");if(s.length<6)return Object(g.showAlert)("Invalid QRCode",5e3),this.setState({error:"Invalid QRCode"}),!1;if(s.length>5&&-1==this.state.checkPointId){var i=s[3];this.setState({firstCheckPoint:i,checkPointId:i-1})}var o=new p.default;(new w.default).postData("/results/addGuestResult/",{today:a,currentTime:n,username:o.getCookie("username")?o.getCookie("username"):window.localStorage.getItem("guest"),scanText:this.state.scanText,checkPointId:this.state.checkPointId,score:this.state.score,timeTaken:this.calculateTimeTaken(),scanNo:this.state.scanNo}).then((function(a){if(a.error)a.endTime&&(window.sessionStorage.setItem("event",s[1]),window.sessionStorage.setItem("course",s[2]),window.sessionStorage.setItem("checkpointNo",s[4]),window.location.href=window.sessionStorage.path+"guest/result/"),Object(g.showAlert)(a.error,5e3),e.setState({error:a.error});else{if(a.startTime){if(a.endTime<n)window.location.href=window.sessionStorage.path+"guest/result/";else{var i=a.endTime.split(":");i=3600*i[0]+60*i[1],n=3600*t.getHours()+60*t.getMinutes(),setTimeout((function(){window.location.href=window.sessionStorage.path+"guest/result/"}),1e3*(i-n))}e.setState({startTime:a.startTime,endTime:a.endTime})}var o=parseInt(a.timeTaken/3600),r=parseInt((a.timeTaken-3600*o)/60),c=a.timeTaken-3600*o-60*r;o=0==(o=o<10?"0"+o:o)?"":o+" h ",r=r<10?"0"+r+" m ":r+" m ",c=c<10?"0"+c+" s":c+" s",e.setState({checkPointId:a.checkPointId,score:a.score,timeTaken:o+r+c,scanNo:a.scanNo,position:a.position})}}))}},{key:"calculateTimeTaken",value:function(){if("0"!=this.state.scanNo){var e=this.state.startTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date;return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()-e}return-1}},{key:"countTimeLeft",value:function(){if(this.state.scanNo>0){var e=this.state.endTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date,a=e-(3600*t.getHours()+60*t.getMinutes()+t.getSeconds()),n=parseInt(a/3600),s=parseInt((a-3600*n)/60),i=a-3600*n-60*s;a=(n=0==(n=n<10?"0"+n:n)?"":n+" : ")+(s=s<10?"0"+s+" : ":s+" : ")+(i=i<10?"0"+i:i),this.setState({timeLeft:a})}}},{key:"renderResult",value:function(){var e=[];this.state.scanNo>0?e.push(u.a.createElement("div",{key:"result"},u.a.createElement("div",{className:"text-left"},": ",this.state.checkPointId-this.state.firstCheckPoint+1),u.a.createElement("div",{className:"text-left"},": ",this.state.scanNo),u.a.createElement("div",{className:"text-left"},": ",this.state.timeTaken),u.a.createElement("div",{className:"text-left"},"Score"==this.state.course?": "+this.state.score:""),u.a.createElement("div",{className:"text-left"},": ",this.state.position),u.a.createElement("div",{className:"text-left"},": ",this.state.timeLeft))):e.push(u.a.createElement("div",{key:"result"},u.a.createElement("div",null,": --"),u.a.createElement("div",null,": --"),u.a.createElement("div",null,": --"),u.a.createElement("div",null,"Score"==this.state.course?": --":""),u.a.createElement("div",null,": --"),u.a.createElement("div",null,": --"))),h.a.render(e,document.getElementById("result"))}}]),a}(u.a.Component));t.default=T},68:function(e,t,a){"use strict";a.r(t);var n=a(0);function s(){Object(n.eId)("preview").style.height=window.innerHeight+"px"}t.default=function(){Object(n.darkLightMode)("scanResults"),s();var e=navigator.userAgent||navigator.vendor||window.opera;/android/i.test(e)||window.addEventListener("resize",s)}},95:function(e,t,a){}}]);