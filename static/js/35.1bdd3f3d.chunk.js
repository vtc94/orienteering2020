(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[35,53,74],{184:function(e,t){},185:function(e,t){},26:function(e,t,a){"use strict";a.r(t);var n=a(5),s=a(14),i=a(2),c=a(11),o=a(46),r=a(12),l=a(13),u=a(1),m=a.n(u),d=a(47),h=a.n(d),v=a(279),f=a.n(v),p=a(17),k=a(3),N=a(4),E=a(58),w=(a(85),function(e){Object(l.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={},n.handleResult=n.handleResult.bind(Object(o.a)(n)),n.countTimeLeft=n.countTimeLeft.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new N.default,a=Object(s.a)({},this.props.course);this.setState({event:a.event,course:a.type,username:t.getCookie("username"),checkPointId:a.firstCheckPoint-1,checkPointNo:a.checkPointNo,firstCheckPoint:a.firstCheckPoint,qrCode:"",score:0,timeTaken:0,speed:0,scanNo:0,position:0}),(new k.default).postData("/results/lastScan/",{event:this.props.course.event,type:this.props.course.type,username:t.getCookie("username")}).then((function(t){if(t.error)Object(p.showAlert)(t.error,5e3);else{var a=parseInt(t.timeTaken/3600),n=parseInt((t.timeTaken-3600*a)/60),s=t.timeTaken-3600*a-60*n;a=0==(a=a<10?"0"+a:a)?"":a+" h ",n=n<10?"0"+n+" m ":n+" m ",s=s<10?"0"+s+" s":s+" s",e.setState({checkPointId:t.checkPointId,score:t.score,timeTaken:a+n+s,scanNo:t.scanNo,position:t.position})}}));var i=this;if(document.getElementById("preview")){var c=new f.a.Scanner({video:document.getElementById("preview"),scanPeriod:5,mirror:!1});c.addListener("scan",(function(e){i.setState(Object(s.a)({},i.state,Object(n.a)({},"qrCode",e))),i.handleResult()})),f.a.Camera.getCameras().then((function(e){e.length>0?c.start(e[0]):window.alert("No camera found")}))}var o=window.setInterval(this.countTimeLeft,1e3);window.sessionStorage.setItem("countTimeLeft",o),Object(E.default)()}},{key:"componentDidUpdate",value:function(){document.getElementById("scanResults")&&this.renderResult(),Object(E.default)()}},{key:"componentWillUnmount",value:function(){clearInterval(window.sessionStorage.countTimeLeft)}},{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement("video",{id:"preview"}),m.a.createElement("div",{id:"scanResults",className:"scanResults col-8 col-sm-6 mx-auto justify-content-center py-4 shadow"},m.a.createElement("h4",{className:"col-12 mb-3"},"Result"),m.a.createElement("div",{className:"col-10 d-flex flex-row justify-content-center mx-auto p-3 shadow"},m.a.createElement("div",{className:"px-1"},m.a.createElement("div",{className:"text-left"},"Checkpoint No"),m.a.createElement("div",{className:"text-left"},"Number of Scans"),m.a.createElement("div",{className:"text-left"},"Time Taken"),m.a.createElement("div",{className:"text-left"},"Score"==this.state.course?"Score":""),m.a.createElement("div",{className:"text-left"},"Position"),m.a.createElement("div",{className:"text-left"},"Time Left")),m.a.createElement("div",{id:"result",className:"result px-1"}))))}},{key:"handleResult",value:function(){var e=this;(new k.default).postData("/results/addResult/",{event:this.state.event,type:this.state.course,username:this.state.username,checkPointNo:this.state.checkPointNo,firstCheckPoint:this.state.firstCheckPoint,checkPointId:this.state.checkPointId,qrCode:this.state.qrCode,score:this.state.score,timeTaken:this.calculateTimeTaken(),scanNo:this.state.scanNo}).then((function(t){if(t.error)Object(p.showAlert)(t.error,5e3),e.setState({error:t.error});else{var a=parseInt(t.timeTaken/3600),n=parseInt((t.timeTaken-3600*a)/60),s=t.timeTaken-3600*a-60*n;a=0==(a=a<10?"0"+a:a)?"":a+" h ",n=n<10?"0"+n+" m ":n+" m ",s=s<10?"0"+s+" s":s+" s",e.setState({checkPointId:t.checkPointId,score:t.score,timeTaken:a+n+s,scanNo:t.scanNo,position:t.position})}}))}},{key:"calculateTimeTaken",value:function(){var e=this.props.course.startTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date;return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()-e}},{key:"countTimeLeft",value:function(){var e=this.props.course.endTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date,a=e-(3600*t.getHours()+60*t.getMinutes()+t.getSeconds()),n=parseInt(a/3600),s=parseInt((a-3600*n)/60),i=a-3600*n-60*s;a=(n=0==(n=n<10?"0"+n:n)?"":n+" : ")+(s=s<10?"0"+s+" : ":s+" : ")+(i=i<10?"0"+i:i),this.setState({timeLeft:a})}},{key:"renderResult",value:function(){var e=[];this.state.scanNo&&this.state.scanNo>0?e.push(m.a.createElement("div",{key:"result"},m.a.createElement("div",{className:"text-left"},": ",this.state.checkPointId-this.state.firstCheckPoint+1),m.a.createElement("div",{className:"text-left"},": ",this.state.scanNo),m.a.createElement("div",{className:"text-left"},": ",this.state.timeTaken),m.a.createElement("div",{className:"text-left"},"Score"==this.state.course?": "+this.state.score:""),m.a.createElement("div",{className:"text-left"},": ",this.state.position),m.a.createElement("div",{className:"text-left"},": ",this.state.timeLeft))):e.push(m.a.createElement("div",{key:"result"},m.a.createElement("div",null,": --"),m.a.createElement("div",null,": --"),m.a.createElement("div",null,": --"),m.a.createElement("div",null,"Score"==this.state.course?": --":""),m.a.createElement("div",null,": --"),m.a.createElement("div",null,": --"))),h.a.render(e,document.getElementById("result"))}}]),a}(m.a.Component));t.default=w},315:function(e,t){},317:function(e,t){},58:function(e,t,a){"use strict";a.r(t);var n=a(0);function s(){Object(n.eId)("preview").style.height=window.innerHeight+"px"}t.default=function(){Object(n.darkLightMode)("scanResults"),s();var e=navigator.userAgent||navigator.vendor||window.opera;/android/i.test(e)||window.addEventListener("resize",s)}},85:function(e,t,a){}}]);