(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[7,27,28,35,53,74],{17:function(e,t,n){"use strict";n.r(t),n.d(t,"showAlert",(function(){return a}));var a=function(e,t){if(document.getElementById("error")){var n=window.sessionStorage.getItem("removeAlert");clearTimeout(n),document.getElementById("error").remove()}var a=document.createElement("div");if(a.id="error",a.innerHTML='<div class="alert alert-warning alert-dismissible fade show" role="alert" style="text-align:center">'+e+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>',document.body.appendChild(a),-1!=t){var s=setTimeout((function(){document.getElementById("error")&&document.getElementById("error").remove()}),t);window.sessionStorage.setItem("removeAlert",s)}}},184:function(e,t){},185:function(e,t){},26:function(e,t,n){"use strict";n.r(t);var a=n(4),s=n(14),i=n(2),r=n(11),o=n(46),c=n(12),l=n(13),u=n(1),d=n.n(u),m=n(47),h=n.n(m),v=n(279),f=n.n(v),p=n(17),k=n(3),w=n(5),E=n(58),N=(n(85),function(e){Object(l.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={},a.handleResult=a.handleResult.bind(Object(o.a)(a)),a.countTimeLeft=a.countTimeLeft.bind(Object(o.a)(a)),a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=new w.default,n=Object(s.a)({},this.props.course);this.setState({event:n.event,course:n.type,username:t.getCookie("username"),checkPointId:n.firstCheckPoint-1,checkPointNo:n.checkPointNo,firstCheckPoint:n.firstCheckPoint,qrCode:"",score:0,timeTaken:0,speed:0,scanNo:0,position:0}),(new k.default).postData("/results/lastScan/",{event:this.props.course.event,type:this.props.course.type,username:t.getCookie("username")}).then((function(t){if(t.error)Object(p.showAlert)(t.error,5e3);else{var n=parseInt(t.timeTaken/3600),a=parseInt((t.timeTaken-3600*n)/60),s=t.timeTaken-3600*n-60*a;n=0==(n=n<10?"0"+n:n)?"":n+" h ",a=a<10?"0"+a+" m ":a+" m ",s=s<10?"0"+s+" s":s+" s",e.setState({checkPointId:t.checkPointId,score:t.score,timeTaken:n+a+s,scanNo:t.scanNo,position:t.position})}}));var i=this;if(document.getElementById("preview")){var r=new f.a.Scanner({video:document.getElementById("preview"),scanPeriod:5,mirror:!1});r.addListener("scan",(function(e){i.setState(Object(s.a)({},i.state,Object(a.a)({},"qrCode",e))),i.handleResult()})),f.a.Camera.getCameras().then((function(e){e.length>0?r.start(e[0]):window.alert("No camera found")}))}var o=window.setInterval(this.countTimeLeft,1e3);window.sessionStorage.setItem("countTimeLeft",o),Object(E.default)()}},{key:"componentDidUpdate",value:function(){document.getElementById("scanResults")&&this.renderResult(),Object(E.default)()}},{key:"componentWillUnmount",value:function(){clearInterval(window.sessionStorage.countTimeLeft)}},{key:"render",value:function(){return d.a.createElement("div",null,d.a.createElement("video",{id:"preview"}),d.a.createElement("div",{id:"scanResults",className:"scanResults col-8 col-sm-6 mx-auto justify-content-center py-4 shadow"},d.a.createElement("h4",{className:"col-12 mb-3"},"Result"),d.a.createElement("div",{className:"col-10 d-flex flex-row justify-content-center mx-auto p-3 shadow"},d.a.createElement("div",{className:"px-1"},d.a.createElement("div",{className:"text-left"},"Checkpoint No"),d.a.createElement("div",{className:"text-left"},"Number of Scans"),d.a.createElement("div",{className:"text-left"},"Time Taken"),d.a.createElement("div",{className:"text-left"},"Score"==this.state.course?"Score":""),d.a.createElement("div",{className:"text-left"},"Position"),d.a.createElement("div",{className:"text-left"},"Time Left")),d.a.createElement("div",{id:"result",className:"result px-1"}))))}},{key:"handleResult",value:function(){var e=this;(new k.default).postData("/results/addResult/",{event:this.state.event,type:this.state.course,username:this.state.username,checkPointNo:this.state.checkPointNo,firstCheckPoint:this.state.firstCheckPoint,checkPointId:this.state.checkPointId,qrCode:this.state.qrCode,score:this.state.score,timeTaken:this.calculateTimeTaken(),scanNo:this.state.scanNo}).then((function(t){if(t.error)Object(p.showAlert)(t.error,5e3),e.setState({error:t.error});else{var n=parseInt(t.timeTaken/3600),a=parseInt((t.timeTaken-3600*n)/60),s=t.timeTaken-3600*n-60*a;n=0==(n=n<10?"0"+n:n)?"":n+" h ",a=a<10?"0"+a+" m ":a+" m ",s=s<10?"0"+s+" s":s+" s",e.setState({checkPointId:t.checkPointId,score:t.score,timeTaken:n+a+s,scanNo:t.scanNo,position:t.position})}}))}},{key:"calculateTimeTaken",value:function(){var e=this.props.course.startTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date;return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()-e}},{key:"countTimeLeft",value:function(){var e=this.props.course.endTime;e=3600*(e=e.split(":"))[0]+60*e[1];var t=new Date,n=e-(3600*t.getHours()+60*t.getMinutes()+t.getSeconds()),a=parseInt(n/3600),s=parseInt((n-3600*a)/60),i=n-3600*a-60*s;n=(a=0==(a=a<10?"0"+a:a)?"":a+" : ")+(s=s<10?"0"+s+" : ":s+" : ")+(i=i<10?"0"+i:i),this.setState({timeLeft:n})}},{key:"renderResult",value:function(){var e=[];this.state.scanNo&&this.state.scanNo>0?e.push(d.a.createElement("div",{key:"result"},d.a.createElement("div",{className:"text-left"},": ",this.state.checkPointId-this.state.firstCheckPoint+1),d.a.createElement("div",{className:"text-left"},": ",this.state.scanNo),d.a.createElement("div",{className:"text-left"},": ",this.state.timeTaken),d.a.createElement("div",{className:"text-left"},"Score"==this.state.course?": "+this.state.score:""),d.a.createElement("div",{className:"text-left"},": ",this.state.position),d.a.createElement("div",{className:"text-left"},": ",this.state.timeLeft))):e.push(d.a.createElement("div",{key:"result"},d.a.createElement("div",null,": --"),d.a.createElement("div",null,": --"),d.a.createElement("div",null,": --"),d.a.createElement("div",null,"Score"==this.state.course?": --":""),d.a.createElement("div",null,": --"),d.a.createElement("div",null,": --"))),h.a.render(e,document.getElementById("result"))}}]),n}(d.a.Component));t.default=N},315:function(e,t){},317:function(e,t){},58:function(e,t,n){"use strict";n.r(t);var a=n(0);function s(){Object(a.eId)("preview").style.height=window.innerHeight+"px"}t.default=function(){Object(a.darkLightMode)("scanResults"),s();var e=navigator.userAgent||navigator.vendor||window.opera;/android/i.test(e)||window.addEventListener("resize",s)}},85:function(e,t,n){}}]);
//# sourceMappingURL=7.212961df.chunk.js.map